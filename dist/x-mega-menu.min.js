/**
 * x mega menu - repsonsive mega menu
 *
 * Copyright (C) 2017 4xmen team <a1gard@4xmen.ir>
 *
 * LICENSE: This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by the Free
 * Software Foundation; either version 3 of the License, or (at your option) any
 * later version.  This program is distributed in the hope that it will be
 * useful, but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General
 * Public License for more details.  You should have received a copy of the GNU
 * General Public License along with this program.
 * If not, see <http://opensource.org/licenses/gpl-license.php>.
 *
 * @package    x-mega-menu
 * @author     4xmen team  <www.4xmen.ir>
 * @author     A1Gard <a1gard@4xmen.ir>
 * @link       https://github.com/4xmen/x-mega-menu
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).xMegaMenu=t()}(this,(function(){"use strict";return window.xMegaMenu=(e,t={responseWidth:"",barsIcon:"",mainTitle:"",isRtl:"",blurEffect:"",resetMenu:"",disableLinks:"",onCloseSideMenu:"",onOpenSideMenu:"",fixedTop:""})=>{let l={responseWidth:1024,mainTitle:"Navbar menu",isRtl:!1,blurEffect:!1,resetMenu:!0,disableLinks:!0,onCloseSideMenu:()=>{},onOpenSideMenu:()=>{},fixedTop:!1,barsIcon:"<img src='data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiID8+DQo8IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPg0KPHN2ZyB3aWR0aD0iNjU3cHQiIGhlaWdodD0iNjU3cHQiIHZpZXdCb3g9IjAgMCA2NTcgNjU3IiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+DQo8ZyBpZD0iI2ZmZmZmZmZmIj4NCjwvZz4NCjxnIGlkPSIjMmYyZjJmZmYiPg0KPHBhdGggZmlsbD0iIzJmMmYyZiIgb3BhY2l0eT0iMS4wMCIgZD0iIE0gMTkzLjM1IDE1Ny41MSBDIDMzNi4yNyAxNTcuMzAgNDc5LjE4IDE1Ny4zMCA2MjIuMTAgMTU3Ljk2IEMgNjI2LjEzIDE1Ny42OCA2MjguNjcgMTYxLjYyIDYyOS44NyAxNjQuOTYgQyA2MzIuODEgMTczLjY2IDYzMi44MSAxODMuMzUgNjI5Ljg3IDE5Mi4wNiBDIDYyOC42NiAxOTUuNDAgNjI2LjEzIDE5OS4zNyA2MjIuMDcgMTk5LjA1IEMgNDk5LjM4IDE5OS43MCAzNzYuNjkgMTk5LjY1IDI1NC4wMCAxOTkuNjQgQyAxODEuOTYgMTk5LjQyIDEwOS45MiAxOTkuNjAgMzcuODggMTk5LjAwIEMgMzMuMzkgMTk4LjIzIDMxLjU2IDE5My4yNCAzMC40MyAxODkuMzggQyAyOC40NCAxODEuMTYgMjguNTIgMTcyLjMyIDMxLjU0IDE2NC4zNiBDIDMyLjc0IDE2MS4yOCAzNS4xOSAxNTcuNzUgMzguOTAgMTU3Ljk3IEMgOTAuMzggMTU3LjY1IDE0MS44NyAxNTcuNTUgMTkzLjM1IDE1Ny41MSBaIiAvPg0KPHBhdGggZmlsbD0iIzJmMmYyZiIgb3BhY2l0eT0iMS4wMCIgZD0iIE0gNTEuMjkgMzA0LjQxIEMgODYuNTUgMzAzLjc3IDEyMS44MSAzMDQuMDYgMTU3LjA2IDMwMy45OCBDIDI5Ny4wMyAzMDMuOTAgNDM3LjAwIDMwMy45NSA1NzYuOTcgMzA0LjAwIEMgNTkyLjMwIDMwNC4xNyA2MDcuNjQgMzA0LjI5IDYyMi45NyAzMDQuNjMgQyA2MjYuOTkgMzA0LjczIDYyOC45MiAzMDguOTEgNjMwLjExIDMxMi4xNyBDIDYzMi43OSAzMjAuNzIgNjMyLjc3IDMzMC4xOCA2MjkuODIgMzM4LjY3IEMgNjI4LjY1IDM0Mi4wMyA2MjYuMTQgMzQ1LjgyIDYyMi4xMCAzNDUuNTIgQyA1NzQuMDcgMzQ2LjQ1IDUyNi4wMiAzNDUuODMgNDc3Ljk4IDM0Ni4wNyBDIDM2OC4zMCAzNDYuMTIgMjU4LjYyIDM0Ni4xMyAxNDguOTMgMzQ2LjA0IEMgMTEyLjAwIDM0NS44OCA3NS4wNCAzNDYuNDAgMzguMTIgMzQ1LjQ2IEMgMzQuMTYgMzQ1LjI2IDMyLjI4IDM0MS4yMiAzMS4wOCAzMzguMDEgQyAyOC4zNSAzMjkuMzcgMjguMzUgMzE5LjgzIDMxLjM4IDMxMS4yNyBDIDMyLjU1IDMwOC4zNCAzNC40NSAzMDQuNzkgMzguMDQgMzA0LjY0IEMgNDIuNDUgMzA0LjQzIDQ2Ljg4IDMwNC41MyA1MS4yOSAzMDQuNDEgWiIgLz4NCjxwYXRoIGZpbGw9IiMyZjJmMmYiIG9wYWNpdHk9IjEuMDAiIGQ9IiBNIDM3LjE1IDQ0OC4yNSBDIDU4LjAzIDQ0Ny42MSA3OS4wMiA0NDguMDIgOTkuOTUgNDQ3Ljc5IEMgMjczLjYyIDQ0Ny40NiA0NDcuMjkgNDQ3LjQ0IDYyMC45NiA0NDcuOTggQyA2MjQuNzggNDQ3LjQwIDYyNy45NyA0NTAuMzUgNjI5LjI5IDQ1My42OSBDIDYzMi44NyA0NjIuNTcgNjMyLjkxIDQ3Mi43NyA2MjkuOTkgNDgxLjg1IEMgNjI4Ljc5IDQ4NS4yOCA2MjYuMjggNDg5LjU0IDYyMi4wNSA0ODkuMTEgQyA1MjEuMzYgNDg5Ljg2IDQyMC42NiA0ODkuNzIgMzE5Ljk3IDQ4OS44NyBDIDI1Ni42NCA0ODkuODQgMTkzLjMxIDQ4OS42MyAxMjkuOTkgNDg5LjY0IEMgOTguOTQgNDg5LjMyIDY3Ljg4IDQ4OS41OSAzNi44NSA0ODguOTUgQyAzMi4wMyA0ODYuNjggMzAuNTcgNDgwLjg3IDI5Ljc3IDQ3Ni4wNiBDIDI4LjQzIDQ2OS40MyAyOS4wNCA0NjIuNTIgMzAuOTUgNDU2LjA2IEMgMzIuMDMgNDUyLjg5IDMzLjcxIDQ0OS4zNSAzNy4xNSA0NDguMjUgWiIgLz4NCjwvZz4NCjwvc3ZnPg0K'  alt='menu bars toggle' />"},i=null;for(const e in t)""!==t[e]&&(l[e]=t[e]);let n=()=>{window.innerWidth<l.responseWidth?o.classList.add("x-responsive"):(o.classList.remove("x-responsive"),s()),l.fixedTop&&(g.style.top=o.offsetHeight+"px",g.parentElement.style.height=o.offsetHeight+"px")},s=()=>{d.classList.remove("x-active"),l.blurEffect&&(document.querySelectorAll(".x-blur").forEach((e=>{e.classList.remove("x-blur")})),l.resetMenu&&document.querySelectorAll(".x-multi-level-menu").forEach((e=>{e.remove()}))),l.onCloseSideMenu()},M=e=>{let t=e.parentNode.closest(".x-main-section-menu"),l=document.createElement("ul");l.innerHTML='<li class="x-back-btn x-desktop"><span>〈 &nbsp; &nbsp; '+r(e)+"</span></li>",l.innerHTML+=e.querySelector("ul").innerHTML;let i=document.createElement("div");i.classList.add("x-multi-level-menu-desktop"),i.append(l),t.append(i),setTimeout((()=>{u()}),500)},u=()=>{l.disableLinks||document.querySelectorAll(".x-has-sub-menu.x-desktop").forEach((e=>{function t(){clearTimeout(i),i=setTimeout((()=>{M(e)}),1e3)}function l(){clearTimeout(i)}e.removeEventListener("mouseenter",t),e.removeEventListener("mouseenter",l),e.addEventListener("mouseenter",t),e.addEventListener("mouseleave",l)}))},c=(e,t,l)=>{document.addEventListener(e,(e=>{let i=document.querySelectorAll(t);if(i){let t=e.target,n=-1;for(;t&&-1===(n=Array.prototype.indexOf.call(i,t));)t=t.parentElement;n>-1&&l.call(t,e)}}))},r=(e,t="")=>{let l=t;return e.childNodes[0].nodeValue.trim().length>0?l=e.childNodes[0].nodeValue.trim():e.querySelectorAll(":scope > a,:scope > span").length>0&&(l=e.querySelector(":scope > a,:scope > span").innerText.trim()),l},a=()=>{o.querySelectorAll("li.x-active").forEach((e=>{e.classList.remove("x-active")}))},o=document.querySelector(e);o.classList.add("x-mega-menu"),o.innerHTML=`<li id="x-toggle">\n            ${l.barsIcon}\n        </li>`+o.innerHTML;let g=document.createElement("div");g.classList.add("x-sub-menu"),o.parentNode.appendChild(g),l.fixedTop&&(o.classList.add("x-fixed-top"),g.style.position="fixed",g.style.left="0",g.style.right="0",g.style.zIndex="99"),o.querySelectorAll(":scope > li").forEach((e=>{e.querySelectorAll("ul").length>0&&e.classList.add("x-has-sub-menu"),e.querySelectorAll(":scope > img, :scope > a > img").length>0&&e.classList.add("x-has-image"),e.addEventListener("mouseenter",(e=>{0!==e.target.querySelectorAll("ul").length?(g.innerHTML=e.target.querySelector("ul").outerHTML,a(),e.target.classList.add("x-active"),g.querySelectorAll(":scope > ul > li").forEach((e=>{e.classList.add("x-main-section-menu")})),g.querySelectorAll("li li").forEach((e=>{e.querySelectorAll("ul").length>0&&(e.classList.add("x-has-sub-menu"),e.classList.add("x-desktop"),l.isRtl&&e.classList.add("x-right"))})),u(),g.classList.add("x-active"),l.blurEffect&&document.querySelectorAll("body > *").forEach((e=>{0===e.querySelectorAll(".x-mega-menu").length&&e.classList.add("x-blur")}))):(g.innerHTML="",g.classList.remove("x-active"),a(),l.blurEffect&&document.querySelectorAll(".x-blur").forEach((e=>{e.classList.remove("x-blur")})))}))})),o.querySelectorAll("li").forEach((e=>{try{let t=e.childNodes[0].nodeValue.trim();t.length>0&&(e.innerHTML=e.innerHTML.split(t).join(`<span>${t}</span>`))}catch{}})),o.parentNode.addEventListener("mouseleave",(()=>{g.innerHTML="",g.classList.remove("x-active"),a(),l.blurEffect&&window.innerWidth>l.responseWidth&&document.querySelectorAll(".x-blur").forEach((e=>{e.classList.remove("x-blur")}))}));let d=document.createElement("div");d.setAttribute("id","x-side-menu"),o.parentNode.appendChild(d),d.innerHTML=`<ul class="x-side-menu">\n    <div class="x-close">\n        &times;\n    </div>\n    <h3>\n        ${l.mainTitle}\n    </h3>\n    ${o.innerHTML}\n</ul>`,d.querySelectorAll(".x-has-sub-menu").forEach((e=>{l.isRtl&&e.classList.add("x-right"),e.innerHTML+='\n        <div class="x-next">\n            〉\n        </div>\n        '})),d.querySelectorAll(".x-always-show,.x-has-image").forEach((e=>{e.remove()})),document.querySelector("#x-toggle").addEventListener("click",(()=>{d.classList.add("x-active"),l.blurEffect&&(document.querySelectorAll("body > *").forEach((e=>{0===e.querySelectorAll(".x-mega-menu").length&&e.classList.add("x-blur")})),document.querySelector(".x-mega-menu").classList.add("x-blur")),l.onOpenSideMenu()})),document.querySelector(".x-close").addEventListener("click",(()=>{s()})),c("click",".x-next",(e=>{let t=document.createElement("div");t.classList.add("x-multi-level-menu"),t.innerHTML=e.target.parentNode.querySelector("ul").outerHTML,e.target.parentNode.closest(".x-side-menu").append(t);let i=r(e.target.parentNode),n=document.createElement("div");n.classList.add("x-back"),n.innerHTML=`${i} <div class="x-back-btn"> 〈 </div>`,t.prepend(n),t.querySelectorAll("li").forEach((e=>{e.querySelectorAll("ul").length>0&&e.classList.add("x-has-sub-menu"),0===e.querySelectorAll(":scope h3").length&&e.classList.add("x-list"),(e.classList.contains("x-highlight")||e.querySelectorAll(":scope > img").length>0)&&e.remove()})),t.querySelectorAll(".x-list").forEach((e=>{e.querySelectorAll("ul").length>0&&(l.isRtl&&e.classList.add("x-right"),e.innerHTML+='\n        <div class="x-next">\n            〉\n        </div>\n        ')}))})),c("click",".x-back",(e=>{e.target.parentNode.closest(".x-multi-level-menu").remove()})),c("click",".x-back-btn.x-desktop",(e=>{e.target.parentNode.closest(".x-multi-level-menu-desktop").remove()})),c("click",".x-has-sub-menu.x-desktop",(e=>{l.disableLinks&&e.preventDefault(),"li"===e.target.tagName?M(e.target):M(e.target.parentNode.closest("li.x-has-sub-menu"))})),d.addEventListener("click",(e=>{"x-side-menu"===e.target.getAttribute("id")&&s()})),window.addEventListener("resize",n,!0),n()}}));
